<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <title>Metrics - MongooseIM</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../custom.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Metrics";
    var mkdocs_page_input_path = "operation-and-maintenance/Mongoose-metrics.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MongooseIM</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Get-to-know-MongooseIM/">ABCs of MongooseIM</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/MongooseIM-High-level-Architecture/">High-level Architecture</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Features-and-supported-standards/">Features and supported standards</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Getting-started/">Getting started</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/release_config/">Release/Installation configuration</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tutorials</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/How-to-build/">How to Build MongooseIM from source code</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Push-notifications/">How to Set up MongoosePush</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/ICE_tutorial/">How to Set up MongooseICE</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/iOS_tutorial/">How to Build an iOS messaging app</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Platform</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Roadmap/">Roadmap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Contributions/">Contributions to ecosystem</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Differentiators/">Differentiators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../History/">History</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Configuration</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Basic-configuration/">Basic Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Advanced-configuration/">Advanced Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced-configuration/database-backends-configuration/">Database backends configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced-configuration/Modules/">Extension Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced-configuration/Listener-modules/">Listener Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced-configuration/acl/">ACL</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../advanced-configuration/Services/">Services</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Authentication methods</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-methods/client-certificate/">Client Certificate</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Authentication backends</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/External-authentication-module/">External Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/HTTP-authentication-module/">HTTP Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/JWT-authentication-module/">JWT Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/LDAP-authentication-module/">LDAP Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/PKI-authentication-module/">PKI Authentication Module</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">MongooseIM open XMPP extensions</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../open-extensions/muc_light/">MUC light</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../open-extensions/token-reconnection/">Token-based reconnection</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">REST API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../rest-api/Client-frontend/">Client/frontend</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../rest-api/Metrics-backend/">Metrics backend</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../rest-api/Administration-backend/">Administration backend</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Operation and maintenance</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../Cluster-management-considerations/">Cluster management considerations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cluster-configuration-and-node-management/">Cluster configuration and node management</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Logging-%26-monitoring/">Logging & monitoring</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Reloading-configuration-on-a-running-system/">Reloading configuration on a running system</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Metrics</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#metrics-types">Metrics types</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#spiral">spiral</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#value">value</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#gauge">gauge</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#proplist">proplist</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#histogram">histogram</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#per-host-metrics">Per host metrics</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#hook-metrics">Hook metrics</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#presences-rosters">Presences &amp; rosters</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#privacy-lists">Privacy lists</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#other">Other</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#extension-specific-metrics">Extension-specific metrics</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#global-metrics">Global metrics</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#data-metrics">Data metrics</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#vm-metrics">VM metrics</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#backend-metrics">Backend metrics</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tls-distribution/">Distribution over TLS</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Developer's guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Testing-MongooseIM/">Testing MongooseIM</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Hooks-and-handlers/">Hooks and Handlers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/hooks_description/">Hooks description</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/message_routing/">Stanza routing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/accumulators/">Accumulators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Moving-to-single-app-project-structure/">Moving to single app project structure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/mod_amp_developers_guide/">mod_amp development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/mod_muc_light_developers_guide/">mod_muc_light developers doc</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/SCRAM-serialization/">SCRAM serialization format</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/xep_tool/">xep-tool usage</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/OpenSSL-and-FIPS/">FIPS mode</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Module index</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_adhoc/">mod_adhoc</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_amp/">mod_amp</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_auth_token/">mod_auth_token</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_blocking/">mod_blocking</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_bosh/">mod_bosh</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_caps/">mod_caps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_carboncopy/">mod_carboncopy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_commands/">mod_commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_csi/">mod_csi</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_inbox/">mod_inbox</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_disco/">mod_disco</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_global_distrib/">mod_global_distrib</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">mod_event_pusher</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher/">mod_event_pusher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_http/">HTTP backend</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_push/">Push backend</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_sns/">SNS backend</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_http_upload/">mod_http_upload</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_jingle_sip/">mod_jingle_sip</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_keystore/">mod_keystore</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_last/">mod_last</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_mam/">mod_mam</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc/">mod_muc</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_commands/">mod_muc_commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_log/">mod_muc_log</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_light/">mod_muc_light</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_light_commands/">mod_muc_light_commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_offline/">mod_offline</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_offline_stub/">mod_offline_stub</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_ping/">mod_ping</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_privacy/">mod_privacy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_private/">mod_private</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_pubsub/">mod_pubsub</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_push_service_mongoosepush/">mod_push_service_mongoosepush</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_register/">mod_register</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_revproxy/">mod_revproxy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_roster/">mod_roster</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_shared_roster_ldap/">mod_shared_roster_ldap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_sic/">mod_sic</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_stream_management/">mod_stream_management</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_time/">mod_time</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_vcard/">mod_vcard</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_version/">mod_version</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MongooseIM</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Operation and maintenance &raquo;</li>
        
      
    
    <li>Metrics</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mongooseim-metrics">MongooseIM metrics</h1>
<p>MongooseIM by default collects many metrics showing the user behaviour and general system statistics.
They are managed by <a href="https://github.com/Feuerlabs/exometer">exometer</a>.
MongooseIM uses <a href="https://github.com/esl/exometer/tree/1.2.1-patched">ESL's fork of this project</a>.</p>
<p>All metrics are divided into the following groups:</p>
<ul>
<li>Per host metrics: Gathered separately for every XMPP host supported by the cluster.
 <strong>Warning:</strong> If a cluster supports many (thousands or more) domains, performance issues might occur.
 To avoid this, use global equivalents of the metrics with <code>all_metrics_are_global</code> config option.<ul>
<li>Hook metrics.
They are created for every <a href="../../developers-guide/Hooks-and-handlers/">hook</a> and incremented on every call to it.</li>
</ul>
</li>
<li>Global metrics: Metrics common for all XMPP hosts.<ul>
<li>Data metrics.
These are misc. metrics related to data transfers (e.g. sent and received stanza size statistics).</li>
<li>VM metrics. Basic Erlang VM statistics.</li>
</ul>
</li>
<li>Backend metrics: Histograms with timings of calls to various backends.</li>
</ul>
<h2 id="metrics-types">Metrics types</h2>
<h3 id="spiral"><code>spiral</code></h3>
<p>This kind of metric provides 2 values: <code>total</code> event count (e.g. stanzas processed) and a value in 60s window (<code>one</code> value).
Dividing <code>one</code> value by 60 provides an average per-second value over last minute.</p>
<p><strong>Example:</strong> <code>[{total, 1000}, {one, 20}]</code></p>
<h3 id="value"><code>value</code></h3>
<p>A simple value.
It is actually a one-element proplist: <code>[{value, N}]</code>.</p>
<p><strong>Example:</strong> <code>[{value, 256}]</code></p>
<h3 id="gauge"><code>gauge</code></h3>
<p>It is similiar to a <code>value</code> type but consists of two properties:</p>
<ul>
<li><code>value</code></li>
<li><code>ms_since_reset</code> - Time in milliseconds elapsed from the last metric update.</li>
</ul>
<p><strong>Example:</strong> <code>[{value, 12}, {ms_since_reset, 91761}]</code></p>
<h3 id="proplist"><code>proplist</code></h3>
<p>A metric which is a nonstandard proplist.
You can find the lists of keys in metrics descriptions.</p>
<p><strong>Example:</strong> <code>[{total,295941736}, {processes_used,263766824}, {atom_used,640435}, {binary,1513152}, {ets,3942592}, {system,32182072}]</code></p>
<h3 id="histogram"><code>histogram</code></h3>
<p>A histogram collects values over a sliding window of 60s and exposes the following stats:</p>
<ul>
<li><code>n</code> - A number of samples.</li>
<li><code>mean</code> - An arithmetic mean.</li>
<li><code>min</code></li>
<li><code>max</code></li>
<li><code>median</code></li>
<li><code>50</code>, <code>75</code>, <code>90</code>, <code>95</code>, <code>99</code>, <code>999</code> - 50th, 75th, 90th, 95th, 99th and 99.9th percentile</li>
</ul>
<h2 id="per-host-metrics">Per host metrics</h2>
<h3 id="hook-metrics">Hook metrics</h3>
<p>There are more hook metrics than what is listed in this table, because they are automatically created for every new hook.
As a result it makes more sense to maintain a list of the most relevant or useful items, rather than keeping this table fully in sync with the code.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description (when it gets incremented)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[Host, anonymous_purge_hook]</code></td>
<td>spiral</td>
<td>An anonymous user disconnects.</td>
</tr>
<tr>
<td><code>[Host, c2s_unauthenticated_iq]</code></td>
<td>spiral</td>
<td>An IQ sent from a user to a server without authentication.</td>
</tr>
<tr>
<td><code>[Host, disco_info]</code></td>
<td>spiral</td>
<td>An information about the server has been requested via Disco protocol.</td>
</tr>
<tr>
<td><code>[Host, disco_local_features]</code></td>
<td>spiral</td>
<td>A list of server features is gathered.</td>
</tr>
<tr>
<td><code>[Host, disco_local_identity]</code></td>
<td>spiral</td>
<td>A list of server identities is gathered.</td>
</tr>
<tr>
<td><code>[Host, disco_local_items]</code></td>
<td>spiral</td>
<td>A list of server's items (e.g. services) is gathered.</td>
</tr>
<tr>
<td><code>[Host, disco_sm_features]</code></td>
<td>spiral</td>
<td>A list of user's features is gathered.</td>
</tr>
<tr>
<td><code>[Host, disco_sm_identity]</code></td>
<td>spiral</td>
<td>A list of user's identities is gathered.</td>
</tr>
<tr>
<td><code>[Host, disco_sm_items]</code></td>
<td>spiral</td>
<td>A list of user's items is gathered.</td>
</tr>
<tr>
<td><code>[Host, mam_lookup_messages]</code></td>
<td>spiral</td>
<td>An archive lookup is performed.</td>
</tr>
<tr>
<td><code>[Host, offline_message_hook]</code></td>
<td>spiral</td>
<td>A message was sent to an offline user. (Except for "error", "headline" and "groupchat" message types.)</td>
</tr>
<tr>
<td><code>[Host, offline_groupchat_message_hook]</code></td>
<td>spiral</td>
<td>A groupchat message was sent to an offline user.</td>
</tr>
<tr>
<td><code>[Host, privacy_updated_list]</code></td>
<td>spiral</td>
<td>User's privacy list is updated.</td>
</tr>
<tr>
<td><code>[Host, resend_offline_messages_hook]</code></td>
<td>spiral</td>
<td>A list of offline messages is gathered for delivery to a user's new connection.</td>
</tr>
<tr>
<td><code>[Host, roster_get_subscription_lists]</code></td>
<td>spiral</td>
<td>Presence subscription lists (based on which presence updates are broadcasted) are gathered.</td>
</tr>
<tr>
<td><code>[Host, roster_in_subscription]</code></td>
<td>spiral</td>
<td>A presence with subscription update is processed.</td>
</tr>
<tr>
<td><code>[Host, roster_out_subscription]</code></td>
<td>spiral</td>
<td>A presence with subscription update is received from a client.</td>
</tr>
<tr>
<td><code>[Host, sm_broadcast]</code></td>
<td>spiral</td>
<td>A stanza is broadcasted to all of user's resources.</td>
</tr>
<tr>
<td><code>[Host, unset_presence_hook]</code></td>
<td>spiral</td>
<td>A user disconnects or sends an <code>unavailable</code> presence.</td>
</tr>
</tbody>
</table>
<h3 id="presences-rosters">Presences &amp; rosters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description (when it gets incremented)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[Host, modPresenceSubscriptions]</code></td>
<td>spiral</td>
<td>Presence subscription is processed.</td>
</tr>
<tr>
<td><code>[Host, modPresenceUnsubscriptions]</code></td>
<td>spiral</td>
<td>Presence unsubscription is processed.</td>
</tr>
<tr>
<td><code>[Host, modRosterGets]</code></td>
<td>spiral</td>
<td>User's roster is fetched.</td>
</tr>
<tr>
<td><code>[Host, modRosterPush]</code></td>
<td>spiral</td>
<td>A roster update is pushed to a single session.</td>
</tr>
<tr>
<td><code>[Host, modRosterSets]</code></td>
<td>spiral</td>
<td>User's roster is updated.</td>
</tr>
</tbody>
</table>
<h3 id="privacy-lists">Privacy lists</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description (when it gets incremented)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[Host, modPrivacyGets]</code></td>
<td>spiral</td>
<td>IQ privacy <code>get</code> is processed.</td>
</tr>
<tr>
<td><code>[Host, modPrivacyPush]</code></td>
<td>spiral</td>
<td>Privacy list update is sent to a single session.</td>
</tr>
<tr>
<td><code>[Host, modPrivacySets]</code></td>
<td>spiral</td>
<td>IQ privacy <code>set</code> is processed.</td>
</tr>
<tr>
<td><code>[Host, modPrivacySetsActive]</code></td>
<td>spiral</td>
<td>Active privacy list is changed.</td>
</tr>
<tr>
<td><code>[Host, modPrivacySetsDefault]</code></td>
<td>spiral</td>
<td>Default privacy list is changed.</td>
</tr>
<tr>
<td><code>[Host, modPrivacyStanzaAll]</code></td>
<td>spiral</td>
<td>A packet is checked against the privacy list.</td>
</tr>
<tr>
<td><code>[Host, modPrivacyStanzaDenied]</code></td>
<td>spiral</td>
<td>Privacy list check resulted in <code>deny</code>.</td>
</tr>
<tr>
<td><code>[Host, modPrivacyStanzaBlocked]</code></td>
<td>spiral</td>
<td>Privacy list check resulted in <code>block</code>.</td>
</tr>
</tbody>
</table>
<h3 id="other">Other</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description (when it gets incremented)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[Host, sessionAuthAnonymous]</code></td>
<td>spiral</td>
<td>A client authenticates anonymously.</td>
</tr>
<tr>
<td><code>[Host, sessionAuthFails]</code></td>
<td>spiral</td>
<td>A client failed to authenticate.</td>
</tr>
<tr>
<td><code>[Host, sessionCount]</code></td>
<td>counter</td>
<td>Number of active sessions.</td>
</tr>
<tr>
<td><code>[Host, sessionLogouts]</code></td>
<td>spiral</td>
<td>A client session is closed.</td>
</tr>
<tr>
<td><code>[Host, sessionSuccessfulLogins]</code></td>
<td>spiral</td>
<td>A client session is opened.</td>
</tr>
<tr>
<td><code>[Host, xmppErrorIq]</code></td>
<td>spiral</td>
<td>An <code>error</code> IQ is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppErrorMessage]</code></td>
<td>spiral</td>
<td>An <code>error</code> message is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppErrorPresence]</code></td>
<td>spiral</td>
<td>An <code>error</code> presence is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppErrorTotal]</code></td>
<td>spiral</td>
<td>A stanza with <code>error</code> type is routed.</td>
</tr>
<tr>
<td><code>[Host, xmppMessageBounced]</code></td>
<td>spiral</td>
<td>A <code>service-unavailable</code> error is sent, because the message recipient if offline.</td>
</tr>
<tr>
<td><code>[Host, xmppIqSent]</code></td>
<td>spiral</td>
<td>An IQ is sent by a client.</td>
</tr>
<tr>
<td><code>[Host, xmppMessageSent]</code></td>
<td>spiral</td>
<td>A message is sent by a client</td>
</tr>
<tr>
<td><code>[Host, xmppPresenceSent]</code></td>
<td>spiral</td>
<td>A presence is sent by a client.</td>
</tr>
<tr>
<td><code>[Host, xmppStanzaSent]</code></td>
<td>spiral</td>
<td>A stanza is sent by a client.</td>
</tr>
<tr>
<td><code>[Host, xmppIqReceived]</code></td>
<td>spiral</td>
<td>An IQ is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppMessageReceived]</code></td>
<td>spiral</td>
<td>A message is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppPresenceReceived]</code></td>
<td>spiral</td>
<td>A presence is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppStanzaReceived]</code></td>
<td>spiral</td>
<td>A stanza is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppStanzaCount]</code></td>
<td>spiral</td>
<td>A stanza is sent to a client.</td>
</tr>
<tr>
<td><code>[Host, xmppStanzaDropped]</code></td>
<td>spiral</td>
<td>A stanza is dropped due to an AMP rule or a <code>filter_packet</code> processing flow.</td>
</tr>
</tbody>
</table>
<h3 id="extension-specific-metrics">Extension-specific metrics</h3>
<p>Metrics specific to an extension, e.g. Message Archive Management, are described in respective module documentation pages.</p>
<p>Below you can find a list of all modules, for which at least one metric is defined.</p>
<ul>
<li><a href="../../modules/mod_csi/"><code>mod_csi</code></a></li>
<li><a href="../../modules/mod_event_pusher_http/"><code>mod_event_pusher_http</code></a></li>
<li><a href="../../modules/mod_http_upload/"><code>mod_http_upload</code></a></li>
<li><a href="../../modules/mod_last/"><code>mod_last</code></a></li>
<li><a href="../../modules/mod_mam/"><code>mod_mam</code></a></li>
<li><a href="../../modules/mod_muc/"><code>mod_muc</code></a></li>
<li><a href="../../modules/mod_muc_light/"><code>mod_muc_light</code></a></li>
<li><a href="../../modules/mod_offline/"><code>mod_offline</code></a></li>
<li><a href="../../modules/mod_privacy/"><code>mod_privacy</code></a></li>
<li><a href="../../modules/mod_private/"><code>mod_private</code></a></li>
<li><a href="../../modules/mod_register/"><code>mod_register</code></a></li>
<li><a href="../../modules/mod_roster/"><code>mod_roster</code></a></li>
<li><a href="../../modules/mod_vcard/"><code>mod_vcard</code></a></li>
</ul>
<h2 id="global-metrics">Global metrics</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description (when it gets incremented)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[global, routingErrors]</code></td>
<td>spiral</td>
<td>It is not possible to route a stanza (all routing handlers failed).</td>
</tr>
<tr>
<td><code>[global, nodeSessionCount]</code></td>
<td>value</td>
<td>A number of sessions connected to a given MongooseIM node.</td>
</tr>
<tr>
<td><code>[global, totalSessionCount]</code></td>
<td>value</td>
<td>A number of sessions connected to a MongooseIM cluster.</td>
</tr>
<tr>
<td><code>[global, uniqueSessionCount]</code></td>
<td>value</td>
<td>A number of unique users connected to a MongooseIM cluster (e.g. 3 sessions of the same user will be counted as 1 in this metric).</td>
</tr>
<tr>
<td><code>[global, cache, unique_sessions_number]</code></td>
<td>gauge</td>
<td>A cached value of <code>uniqueSessionCount</code>. It is automatically updated when a unique session count is calculated.</td>
</tr>
<tr>
<td><code>[global nodeUpTime]</code></td>
<td>value</td>
<td>Node uptime.</td>
</tr>
</tbody>
</table>
<h3 id="data-metrics">Data metrics</h3>
<table>
<thead>
<tr>
<th>Metric name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[global, data, xmpp, received, xml_stanza_size]</code></td>
<td>histogram</td>
<td>A size (in bytes) of a received stanza after decompression and decryption.</td>
</tr>
<tr>
<td><code>[global, data, xmpp, sent, xml_stanza_size]</code></td>
<td>histogram</td>
<td>A size (in bytes) of a stanza sent to a client socket.</td>
</tr>
<tr>
<td><code>[global, data, xmpp, received, compressed_size]</code></td>
<td>histogram</td>
<td>A size (in bytes) of a received stanza before decompression.</td>
</tr>
<tr>
<td><code>[global, data, xmpp, sent, compressed_size]</code></td>
<td>histogram</td>
<td>A size (in bytes) of a stanza after compression.</td>
</tr>
<tr>
<td><code>[global, data, xmpp, received, encrypted_size]</code></td>
<td>histogram</td>
<td>A size (in bytes) of a received stanza before decryption.</td>
</tr>
<tr>
<td><code>[global, data, xmpp, sent, encrypted_size]</code></td>
<td>histogram</td>
<td>A size (in bytes) of a stanza after encryption.</td>
</tr>
<tr>
<td><code>[global, data, dist]</code></td>
<td>proplist</td>
<td>Network stats for an Erlang distributed communication. A proplist with values: <code>recv_oct</code>, <code>recv_cnt</code>, <code>recv_max</code>, <code>send_oct</code>, <code>send_max</code>, <code>send_cnt</code>, <code>send_pend</code>, <code>connections</code></td>
</tr>
<tr>
<td><code>[global, data, odbc, PoolName]</code></td>
<td>proplist</td>
<td>For every ODBC pool defined, an instance of this metric is available. It is a proplist with values <code>workers</code>, <code>recv_oct</code>, <code>recv_cnt</code>, <code>recv_max</code>, <code>send_oct</code>, <code>send_max</code>, <code>send_cnt</code>, <code>send_pend</code>.</td>
</tr>
</tbody>
</table>
<h3 id="vm-metrics">VM metrics</h3>
<table>
<thead>
<tr>
<th>Metric name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[global, erlang, memory]</code></td>
<td>proplist</td>
<td>A proplist with <code>total</code>, <code>processes_used</code>, <code>atom_used</code>, <code>binary</code>, <code>ets</code> and <code>system</code> memory stats.</td>
</tr>
<tr>
<td><code>[global, erlang, system_info]</code></td>
<td>proplist</td>
<td>A proplist with <code>port_count</code>, <code>port_limit</code>, <code>process_count</code>, <code>process_limit</code>, <code>ets_limit</code> stats.</td>
</tr>
</tbody>
</table>
<h2 id="backend-metrics">Backend metrics</h2>
<p>Some extension modules expose histograms with timings of calls made to their backends.
Please check the documentation of modules that are enabled in your config file, in order to learn if they provide them.</p>
<p>Besides these, following authentication metrics are always available:</p>
<ul>
<li><code>[Host, backends, auth, authorize]</code></li>
<li><code>[Host, backends, auth, check_password]</code></li>
<li><code>[Host, backends, auth, try_register]</code></li>
<li><code>[Host, backends, auth, does_user_exist]</code></li>
</ul>
<p>These are <strong>total</strong> times of respective operations.
One operation usually requires only a single call to an auth backend but sometimes with e.g. 3 backends configured, the operation may fail for first 2 backends.
In such case, these metrics will be updated with combined time of 2 failed and 1 successful request.</p>
<p>Additionaly, RDMBS layer in MongooseIM exposes one more metric, if RDBMS is configured:</p>
<ul>
<li><code>[global, backends, mongoose_rdbms, query]</code> - Execution time of a "not prepared" query by a DB driver.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tls-distribution/" class="btn btn-neutral float-right" title="Distribution over TLS">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Reloading-configuration-on-a-running-system/" class="btn btn-neutral" title="Reloading configuration on a running system"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Reloading-configuration-on-a-running-system/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../tls-distribution/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
