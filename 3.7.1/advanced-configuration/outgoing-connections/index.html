<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <title>Outgoing connections - MongooseIM</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../custom.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Outgoing connections";
    var mkdocs_page_input_path = "advanced-configuration/outgoing-connections.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MongooseIM</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Get-to-know-MongooseIM/">ABCs of MongooseIM</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/MongooseIM-High-level-Architecture/">High-level Architecture</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Features-and-supported-standards/">Features and supported standards</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Getting-started/">Getting started</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/release_config/">Release/Installation configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Bootstrap-Scripts/">Bootstrap scripts</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tutorials</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/How-to-build/">How to Build MongooseIM from source code</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/push-notifications/Push-notifications/">How to Set up Push Notifications</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/push-notifications/Push-notifications-client-side/">How to Set up Push Notifications on the client side</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/push-notifications/With-MongoosePush/">How to Set up MongoosePush</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/ICE_tutorial/">How to Set up MongooseICE</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/iOS_tutorial/">How to Build an iOS messaging app</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../user-guide/Jingle-SIP-setup/">How to Set up Jingle/SIP</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Migration Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/3.1.1_3.2.0/">3.1.1 to 3.2.0</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/3.3.0_3.4.0/">3.3.0 to 3.4.0</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/3.5.0_3.6.0/">3.5.0 to 3.6.0</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/3.6.0_3.7.0/">3.6.0 to 3.7.0</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../migrations/jid-from-mam-muc-script/">MAM MUC migration helper</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Platform</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../Contributions/">Contributions to ecosystem</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Differentiators/">Differentiators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../History/">History</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Configuration</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../../Basic-configuration/">Basic Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Erlang-cookie-security/">Erlang Cookie Security</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../Advanced-configuration/">Advanced Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../TLS-hardening/">TLS hardening</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../database-backends-configuration/">Database backends configuration</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Outgoing connections</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#rdbms-connection-setup">RDBMS connection setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#connection-options">Connection options</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#mysql-and-postgresql-ssl-connection-setup">MySQL and PostgreSQL SSL connection setup</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#http-connections-setup">HTTP connections setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example-configuration_2">Example configuration</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#redis-connection-setup">Redis connection setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#riak-connection-setup">Riak connection setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#riak-ssl-connection-setup">Riak SSL connection setup</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example-configuration_3">Example configuration</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cassandra-connection-setup">Cassandra connection setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#connectionoptions">ConnectionOptions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example_1">Example</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ssl-connection-setup">SSL connection setup</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#create-server-keystore">Create server keystore</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#change-the-cassandra-configuration-file">Change the Cassandra configuration file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#enable-mongooseim-to-connect-with-ssl">Enable MongooseIM to connect with SSL</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#testing-the-connection">Testing the connection</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#elasticsearch-connection-setup">ElasticSearch connection setup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#rabbitmq-connection-setup">RabbitMQ connection setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example_2">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ldap-connection-setup">LDAP connection setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#connection-options_1">Connection options</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example_3">Example</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Modules/">Extension Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Listener-modules/">Listener Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../acl/">ACL</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Services/">Services</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Authentication methods</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-methods/client-certificate/">Client Certificate</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Authentication backends</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/External-authentication-module/">External Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/HTTP-authentication-module/">HTTP Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/JWT-authentication-module/">JWT Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/LDAP-authentication-module/">LDAP Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/PKI-authentication-module/">PKI Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/Riak-authentication-module/">Riak Authentication Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../authentication-backends/Dummy-authentication-module/">Dummy Authentication Module</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">MongooseIM open XMPP extensions</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../open-extensions/muc_light/">MUC light</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../open-extensions/token-reconnection/">Token-based reconnection</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">REST API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../rest-api/Client-frontend/">Client/frontend</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../rest-api/Metrics-backend/">Metrics backend</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../rest-api/Administration-backend/">Administration backend</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Operation and maintenance</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/gdpr-considerations/">GDPR considerations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/Cluster-management-considerations/">Cluster management considerations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/Cluster-configuration-and-node-management/">Cluster configuration and node management</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/Logging-%26-monitoring/">Logging & monitoring</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/Reloading-configuration-on-a-running-system/">Reloading configuration on a running system</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/Mongoose-metrics/">Metrics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/System-Metrics-Privacy-Policy/">System Metrics Privacy Policy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/tls-distribution/">Distribution over TLS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../operation-and-maintenance/known-issues/">Known issues</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Developer's guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Testing-MongooseIM/">Testing MongooseIM</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/logging/">Logging</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Hooks-and-handlers/">Hooks and Handlers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/hooks_description/">Hooks description</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/message_routing/">Stanza routing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/accumulators/">Accumulators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/flat_options/">Flat options format</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Moving-to-single-app-project-structure/">Moving to single app project structure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/mod_amp_developers_guide/">mod_amp development</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/mod_muc_light_developers_guide/">mod_muc_light developers doc</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/SCRAM-serialization/">SCRAM serialization format</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/xep_tool/">xep-tool usage</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/OpenSSL-and-FIPS/">FIPS mode</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/Basic-iq-handler/">Basic IQ Handler</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../developers-guide/mongoose_wpool/">mongoose_wpool</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Module index</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_adhoc/">mod_adhoc</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_amp/">mod_amp</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_auth_token/">mod_auth_token</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_blocking/">mod_blocking</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_bosh/">mod_bosh</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_caps/">mod_caps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_carboncopy/">mod_carboncopy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_commands/">mod_commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_csi/">mod_csi</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_inbox/">mod_inbox</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_disco/">mod_disco</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_global_distrib/">mod_global_distrib</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">mod_event_pusher</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher/">mod_event_pusher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_http/">HTTP backend</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_push/">Push backend</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_sns/">SNS backend</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/mod_event_pusher_rabbit/">RabbitMQ backend</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_http_upload/">mod_http_upload</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_jingle_sip/">mod_jingle_sip</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_keystore/">mod_keystore</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_last/">mod_last</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_mam/">mod_mam</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc/">mod_muc</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_commands/">mod_muc_commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_log/">mod_muc_log</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_light/">mod_muc_light</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_muc_light_commands/">mod_muc_light_commands</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_offline/">mod_offline</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_offline_stub/">mod_offline_stub</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_ping/">mod_ping</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_privacy/">mod_privacy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_private/">mod_private</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_pubsub/">mod_pubsub</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_push_service_mongoosepush/">mod_push_service_mongoosepush</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_register/">mod_register</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_revproxy/">mod_revproxy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_roster/">mod_roster</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_shared_roster_ldap/">mod_shared_roster_ldap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_sic/">mod_sic</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_stream_management/">mod_stream_management</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_time/">mod_time</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_vcard/">mod_vcard</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mod_version/">mod_version</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MongooseIM</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Configuration &raquo;</li>
        
      
    
    <li>Outgoing connections</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="outgoing-connections">Outgoing connections</h1>
<p>MongooseIM can be configured to talk to external service like databases or HTTP servers in order to get or set the required data.
The interface for outgoing connections management was unified and is now available via the <code>outgoing_pools</code> config option for the following type of connections:</p>
<ul>
<li><code>cassandra</code> - pool of connections to Cassandra cluster</li>
<li><code>riak</code> - pool of connections to Riak cluster</li>
<li><code>redis</code> - pool of connections to Redis server</li>
<li><code>http</code> - pool of connections to various HTTP(S) servers MongooseIM can talk to, in example HTTP authentication backend or HTTP notifications</li>
<li><code>elastic</code> - pool of connections to ElasticSearch server</li>
<li><code>rdbms</code> - pool of connections to an RDBMS database</li>
<li><code>rabbit</code> - pool of connections to a RabbitMQ server</li>
<li><code>ldap</code> - pool of connections to an LDAP server</li>
<li><code>generic</code> - pool of generic workers not associated directly with a particular connection (SNS, PushNotifications)</li>
</ul>
<p>All the above pools are managed by <a href="https://github.com/inaka/worker_pool">inaka/worker_pool</a> library.</p>
<p>Every entry in the <code>outgoing_pools</code> is a 5-element tuple:</p>
<pre><code class="language-erlang">{Type, Host, Tag, PoolOptions, ConnectionOptions}
</code></pre>
<p>Where:</p>
<ul>
<li><code>Type</code> is one of the types listed above</li>
<li><code>Host</code> can be set to:<ul>
<li><code>global</code> - meaning the pool will started once no matter how many XMPP hosts served by MongooseIM</li>
<li><code>host</code> - the pool will be started for all the XMPP hosts served by MongooseIM</li>
<li>a binary representing a specific XMPP host like <code>&lt;&lt;"domain1.chat.im"&gt;&gt;</code></li>
</ul>
</li>
<li><code>Tag</code> is a name to distinguish pools with the same <code>Type</code> and <code>Host</code> parameter.</li>
<li><code>PoolOptions</code> is a list of <code>{key, value}</code> pairs as defined in <a href="https://github.com/inaka/worker_pool#starting-a-pool">worker_pool doc</a>
   with the following exception:<ul>
<li><code>strategy</code> - specifies the worker selection strategy for the given pool, default is <code>best_worker</code>,
  more details on this can be found in <a href="https://github.com/inaka/worker_pool#choosing-a-strategy">Choosing strategy in worker_pool doc</a>
  <em>WARNING:</em> <code>redis</code> and <code>riak</code> backends are not compatible with <code>available_worker</code> strategy.</li>
<li><code>call_timeout</code> - specifies the timeout, in milliseconds, for a call operation to the pool</li>
</ul>
</li>
<li><code>ConnectionOptions</code> - options list passed to the <code>start</code> function of the pool type</li>
</ul>
<h3 id="examples">Examples</h3>
<p>Provided MongooseIM serves domains <code>&lt;&lt;"a.com"&gt;&gt;</code>, <code>&lt;&lt;"b.com"&gt;&gt;</code>, <code>&lt;&lt;"c.eu"&gt;&gt;</code> and <code>&lt;&lt;"d.eu"&gt;&gt;</code>
the following <code>outgoing_pools</code> configuration:</p>
<pre><code class="language-erlang">{redis, &lt;&lt;&quot;a.com&quot;&gt;&gt;, default, PoolOpts, ConnOptsForDomain1},
{redis, host, default, PoolOpts, ConnOpts},
{redis, &lt;&lt;&quot;c.eu&quot;, default, PoolOpts, ConnOptsForDomain2}
</code></pre>
<p>will be expanded to the following configuration:</p>
<pre><code class="language-erlang">{redis, &lt;&lt;&quot;a.com&quot;&gt;&gt;, default, PoolOpts, ConnOptsForDomain1},
{redis, &lt;&lt;&quot;b.com&quot;&gt;&gt;, default, PoolOpts, ConnOpts},
{redis, &lt;&lt;&quot;c.eu&quot;, default, PoolOpts, ConnOptsForDomain2},
{redis, &lt;&lt;&quot;d.eu&quot;&gt;&gt;, default, PoolOpts, ConnOpts}
</code></pre>
<h2 id="rdbms-connection-setup">RDBMS connection setup</h2>
<p>An example RDBMS configuration inside <code>outgoing_pools</code> may look like this:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {rdbms, global, default, [{workers, 5}],
  [{server, {mysql, &quot;localhost&quot;, 3306, &quot;mydb&quot;, &quot;user&quot;, &quot;passwd&quot;}}]}
]}.
</code></pre>
<p>This configuration will create a default, global pool of 5 connections to a mysql database.
We might also want to add a dedicated pool for a specific host:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {rdbms, global, default, [{workers, 5}],
  [{server, {mysql, &quot;localhost&quot;, 3306, &quot;mydb&quot;, &quot;user&quot;, &quot;passwd&quot;}}]},
 {rdbms, &quot;myhost.com&quot;, default, [{workers, 3}],
  [{server, {mysql, &quot;localhost&quot;, 3306, &quot;mydb&quot;, &quot;user&quot;, &quot;passwd&quot;}}]}
]}.
</code></pre>
<p>Please remember that SQL databases require creating a schema.
See <a href="../database-backends-configuration/">Database backends configuration</a> for more information.
Also see <a href="../../Advanced-configuration/">Advanced configuration</a> for additional options that influence RDBMS connections.
Currently all pools must use the same RDBMS type (e.g. <code>mysql</code>, <code>pgsql</code>).</p>
<h3 id="connection-options">Connection options</h3>
<ul>
<li>
<p><strong>server</strong></p>
<ul>
<li><strong>Description:</strong> SQL DB connection configuration. Currently supported DB types are <code>mysql</code> and <code>pgsql</code>.</li>
<li><strong>Syntax:</strong> <code>{server, {Type, Host, Port, DBName, Username, Password}}.</code> <strong>or</strong> <code>{server, "&lt;ODBC connection string&gt;"}</code></li>
<li><strong>Default:</strong> <code>undefined</code></li>
</ul>
</li>
<li>
<p><strong>keepalive_interval</strong></p>
<ul>
<li><strong>Description:</strong> When enabled, will send <code>SELECT 1</code> query through every DB connection at given interval to keep them open.
This option should be used to ensure that database connections are restarted after they became broken (e.g. due to a database restart or a load balancer dropping connections).
Currently, not every network related error returned from a database driver to a regular query will imply a connection restart.</li>
<li><strong>Syntax:</strong> <code>{keepalive_interval, IntervalSeconds}.</code></li>
<li><strong>Example:</strong> <code>{keepalive_interval, 30}.</code></li>
<li><strong>Default:</strong> <code>undefined</code></li>
</ul>
</li>
</ul>
<h4 id="mysql-and-postgresql-ssl-connection-setup">MySQL and PostgreSQL SSL connection setup</h4>
<p>In order to establish a secure connection with a database, additional options must be passed in the <code>server</code> tuple.
Here is the proper syntax:</p>
<p><code>{server, {Type, Host, Port, DBName, Username, Password, SSL}}.</code></p>
<h5 id="mysql">MySQL</h5>
<p>SSL configuration options for MySQL:</p>
<ul>
<li><strong>SSL</strong><ul>
<li><strong>Description:</strong> Specifies SSL connection options.</li>
<li><strong>Syntax:</strong> <code>[Opt]</code></li>
<li><strong>Supported values:</strong> The options are just a <strong>list</strong> of Erlang <code>ssl:ssl_option()</code>. More details can be found in <a href="http://erlang.org/doc/man/ssl.html">official Erlang ssl documentation</a>.</li>
</ul>
</li>
</ul>
<h6 id="example-configuration">Example configuration</h6>
<p>An example configuration can look as follows:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {rdbms, global, default, [{workers, 5}],
  [{server, {mysql, &quot;localhost&quot;, 3306, &quot;mydb&quot;, &quot;mim&quot;, &quot;mimpass&quot;,
             [{versions, ['tlsv1.2']},
              {verify, verify_peer},
              {cacertfile, &quot;path/to/cacert.pem&quot;},
              {server_name_indication, disable}]}}]}
]}.
</code></pre>
<h5 id="postgresql">PostgreSQL</h5>
<p>SSL configuration options for PGSQL:</p>
<ul>
<li>
<p><strong>SSL</strong></p>
<ul>
<li><strong>Description:</strong> Specifies general options for SSL connection.</li>
<li><strong>Syntax:</strong> <code>[SSLMode, SSLOpts]</code></li>
</ul>
</li>
<li>
<p><strong>SSLMode</strong></p>
<ul>
<li><strong>Description:</strong> Specifies a mode of SSL connection. Mode expresses how much the PostgreSQL driver carries about security of the connections.
For more information click <a href="https://github.com/epgsql/epgsql">here</a>.</li>
<li><strong>Syntax:</strong> <code>{ssl, Mode}</code></li>
<li><strong>Supported values:</strong> <code>false</code>, <code>true</code>, <code>required</code></li>
</ul>
</li>
<li>
<p><strong>SSLOpts</strong></p>
<ul>
<li><strong>Description:</strong> Specifies SSL connection options.</li>
<li><strong>Syntax:</strong> <code>{ssl_opts, [Opt]}</code></li>
<li><strong>Supported values:</strong> The options are just a <strong>list</strong> of Erlang <code>ssl:ssl_option()</code>. More details can be found in <a href="http://erlang.org/doc/man/ssl.html">official Erlang ssl documentation</a>.</li>
</ul>
</li>
</ul>
<h6 id="example-configuration_1">Example configuration</h6>
<p>An example configuration can look as follows:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {rdbms, global, default, [{workers, 5}],
  [{server, {pgsql, &quot;localhost&quot;, 5432, &quot;mydb&quot;, &quot;mim&quot;, &quot;mimpass&quot;,
             [{ssl, required}, {ssl_opts, [{verify, verify_peer}, {cacertfile, &quot;path/to/cacert.pem&quot;}]}]}}]}
]}.
</code></pre>
<h5 id="odbc-ssl-connection-setup">ODBC SSL connection setup</h5>
<p>If you've configured MongooseIM to use an ODBC driver, i.e. you've provided an ODBC connection string in the <code>server</code> option, e.g.</p>
<pre><code class="language-erlang">{server, &quot;DSN=mydb&quot;}.
</code></pre>
<p>then the SSL options, along other connection options, should be present in the <code>~/.odbc.ini</code> file.</p>
<p>To enable SSL connection the <code>sslmode</code> option needs to be set to <code>verify-full</code>.
Additionally, you can provide the path to the CA certificate using the <code>sslrootcert</code> option.</p>
<h6 id="example-odbcini-configuration">Example ~/.odbc.ini configuration</h6>
<pre><code>[mydb]
Driver      = ...
ServerName  = ...
Port        = ...
...
sslmode     = verify-full
sslrootcert = /path/to/ca/cert
</code></pre>
<h2 id="http-connections-setup">HTTP connections setup</h2>
<p>Some MongooseIM modules need an HTTP connection to external service.
These pools need to be configured and started before the module needs them.
Below is a sample configuration:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {http, global, default, PoolOptions, ConnectionOptions}
]}.
</code></pre>
<p><code>PoolOptions</code> are described above, below there are the recommended <code>PoolOptions</code> for <code>HTTP</code> pools:</p>
<ul>
<li><code>strategy</code> - the recommended value is <code>available_worker</code></li>
<li><code>call_timeout</code> - it should be equal or longer than the value set in <code>request_timeout</code> below.</li>
</ul>
<p><code>ConnectionOptions</code> can take the following <code>{key, value}</code> pairs:</p>
<ul>
<li><code>{server, HostName}</code> - string, default: <code>"http://localhost"</code> - the URL of the destination HTTP server (including a port number if needed).</li>
<li><code>{path_prefix, Prefix}</code> - string, default: <code>"/"</code> - the part of the destination URL that is appended to the host name (<code>host</code> option).</li>
<li><code>{request_timeout, TimeoutValue}</code> - non-negative integer, default: <code>2000</code> - maximum number of milliseconds to wait for the HTTP response.</li>
<li><code>{http_opts, HTTPOptions}</code> - list, default: <code>[]</code> - can be used to pass extra parameters which are passed to <a href="https://github.com/esl/fusco">fusco</a>, the library used for making the HTTP calls.
  More details about the possible <code>http_opts</code> can be found in <a href="https://github.com/esl/fusco">fusco</a>'s documentation.</li>
</ul>
<h5 id="example-configuration_2">Example configuration</h5>
<pre><code class="language-Erlang">{outgoing_pools, [
  {http, global, http_auth,
   [{strategy, available_worker}], [{server, &quot;https://my_server:8080&quot;}]}
]}.
</code></pre>
<p>If peer certificate verification is required, the pool can be configured in the following way:</p>
<pre><code class="language-Erlang">{outgoing_pools, [
  {http, global, mongoose_push_http,
   [{workers, 50}],
   [{server, &quot;https://localhost:8443&quot;},
    {http_opts, [
                 {connect_options, [{verify, verify_peer}]}
                 ]}
   ]}
]}.
</code></pre>
<p>Please note the <code>connect_options</code> passed to <a href="https://github.com/esl/fusco">fusco</a> via the pool's <code>http_opts</code> parameter.</p>
<h2 id="redis-connection-setup">Redis connection setup</h2>
<p>Session manager backend or <code>mod_global_distrib</code> requires a redis pool defined in the <code>outgoing_pools</code> option.
They can be defined as follows:</p>
<pre><code class="language-erlang">{ougtoing_pools, [
 {redis, global, Tag, WorkersOptions, ConnectionOptions}
]}.
</code></pre>
<p><em>WARNING:</em> <code>redis</code> backend is not compatible with <code>available_worker</code> strategy.</p>
<p>The <code>Tag</code> parameter can only be set to <code>default</code> for a session backend.
For <code>mod_global_distrib</code> module it can take any value (default is <strong>global_distrib</strong>) but the name needs to be passed as:</p>
<pre><code class="language-erlang">{redis, [{pool, Tag}]}
</code></pre>
<p>in the <code>mod_global_distrib</code> options. See <a href="../../modules/mod_global_distrib/">mod_global_distrib doc</a> for details and examples.</p>
<p>The <code>ConnectionOptions</code> list can take following parametrs as <code>{key, value</code>} pairs:</p>
<ul>
<li><strong>host</strong> (default: <strong>"localhost"</strong>) the hostname or IP address of the Redis server</li>
<li><strong>port</strong> (default: <strong>6379</strong>) the port of the Redis server</li>
<li><strong>database</strong> (default: <strong>0</strong>) number of the database to use by the pool</li>
<li><strong>password</strong> (default: <strong>""</strong>) the password to the database (if set).</li>
</ul>
<h3 id="example">Example</h3>
<pre><code class="language-erlang">{ougtoing_pools, [
 {redis, global, default, [{strategy, random_worker}],
  [{host, &quot;198.172.15.12&quot;},
   {port, 9923}]}
]}.
</code></pre>
<h2 id="riak-connection-setup">Riak connection setup</h2>
<p>Currently only one Riak connection pool can exist for each supported XMPP host.
It is configured with the following tuple inside the <code>outgoing_pools</code> config option.</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {riak, global, default, [{workers, 20}], [{address, &quot;127.0.0.1&quot;}, {port, 8087}]}
]}.
</code></pre>
<p><em>WARNING:</em> <code>riak</code> backend is not compatible with <code>available_worker</code> strategy.</p>
<h4 id="riak-ssl-connection-setup">Riak SSL connection setup</h4>
<p>Using SSL for Riak connection requires passing extra options in <code>ConnectionOptions</code> to the
aforementioned <code>riak</code> tuple.</p>
<p>Here is the proper syntax:</p>
<ul>
<li>
<p><strong>Credentials</strong></p>
<ul>
<li><strong>Description:</strong> Specifies credentials to use to connect to the database.</li>
<li><strong>Syntax:</strong> <code>{credentials, User, Password}</code></li>
<li><strong>Supported values</strong> <code>User</code> and <code>Password</code> are strings with a database username and password respectively.</li>
</ul>
</li>
<li>
<p><strong>CACert</strong></p>
<ul>
<li><strong>Description:</strong> Specifies a path to the CA certificate that was used to sign the database certificates.</li>
<li><strong>Syntax:</strong> <code>{cacertfile, Path}</code></li>
<li><strong>Supported values</strong> <code>Path</code> is a string with a path to the CA certificate file.</li>
</ul>
</li>
<li>
<p><strong>SSL_Opts</strong></p>
<ul>
<li><strong>Description</strong>: list of SSL options as defined in <a href="http://erlang.org/doc/man/ssl.html">Erlang SSL module doc</a>
  They will be passed verbatim to the <code>ssl:connect</code> function.</li>
<li><strong>Syntax</strong> <code>{ssl_opts, ListOfSSLOpts}</code></li>
<li><strong>Example</strong>:</li>
</ul>
</li>
</ul>
<pre><code class="language-erlang">{ssl_opts, [{ciphers, [&quot;AES256-SHA&quot;, &quot;DHE-RSA-AES128-SHA256&quot;]},
            {server_name_indication, disable}]}
</code></pre>
<h5 id="example-configuration_3">Example configuration</h5>
<p>An example configuration can look as follows:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {riak, global, default, [{workers, 20}, {strategy, next_worker}],
   [{address, &quot;127.0.0.1&quot;}, {port, 8087},
    {credentials, &quot;username&quot;, &quot;pass&quot;},
    {cacertfile, &quot;path/to/cacert.pem&quot;}]}
]}.
</code></pre>
<h2 id="cassandra-connection-setup">Cassandra connection setup</h2>
<p>The minimum pool definition for cassandra workers looks as follows:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {cassandra, global, default, [], []}
]}.
</code></pre>
<p>In this case MongooseIM will by default try to connect to Cassandra server on "localhost" and port 9042.
The keyspace used in queries will be <code>mongooseim</code>.</p>
<h4 id="connectionoptions">ConnectionOptions</h4>
<p>The <code>ConnectionOptions</code> list can take following parameters as <code>{key, Value}</code> pairs:</p>
<ul>
<li><strong>servers</strong> - A list of servers in Cassandra cluster in <code>{HostnameOrIP, Port}</code> format.</li>
<li><strong>keyspace</strong> - A name of keyspace to use in queries executed in this pool.</li>
<li>You can find a full list in <code>cqerl</code> <a href="https://github.com/matehat/cqerl#all-modes">documentation</a>.</li>
</ul>
<h4 id="example_1">Example</h4>
<pre><code>{cassandra, global, default, [],
  [
   {servers, [{&quot;cassandra_server1.example.com&quot;, 9042}, {&quot;cassandra_server2.example.com&quot;, 9042}] },
   {keyspace, &quot;big_mongooseim&quot;}
  ]
 ]}
</code></pre>
<h4 id="ssl-connection-setup">SSL connection setup</h4>
<p>In order to establish a secure connection to Cassandra you must make some changes in the MongooseIM and Cassandra configuration files.</p>
<h5 id="create-server-keystore">Create server keystore</h5>
<p>Follow <a href="https://docs.datastax.com/en/cassandra/3.0/cassandra/configuration/secureSSLCertWithCA.html">this</a> guide if you need to create certificate files.</p>
<h5 id="change-the-cassandra-configuration-file">Change the Cassandra configuration file</h5>
<p>Find <code>client_encryption_options</code> in <code>cassandra.yaml</code> and make these changes:</p>
<pre><code class="language-yaml">client_encryption_options:
    enabled: true
    keystore: /your_certificate_directory/server.keystore
    keystore_password: your_password
</code></pre>
<p>Save the changes and restart Cassandra.</p>
<h5 id="enable-mongooseim-to-connect-with-ssl">Enable MongooseIM to connect with SSL</h5>
<p>An SSL connection can be established with both self-signed and CA-signed certificates.</p>
<h6 id="self-signed-certificate">Self-signed certificate</h6>
<p>Add the following to <code>ConnectionOptions</code> list:</p>
<pre><code class="language-erlang">{ssl, [{verify, verify_none}]}
</code></pre>
<p>Save the changes and restart MongooseIM.</p>
<h6 id="ca-signed-certificate">CA-signed certificate</h6>
<p>Add the following to <code>ConnectionOptions</code> list:</p>
<pre><code>{ssl, [{cacertfile,
        &quot;/path/to/rootCA.pem&quot;},
       {verify, verify_peer}]}
</code></pre>
<p>Save the changes and restart MongooseIM.</p>
<h5 id="testing-the-connection">Testing the connection</h5>
<p>Make sure Cassandra is running and then run MongooseIM in live mode:</p>
<pre><code class="language-bash"> $ ./mongooseim live
 $ (mongooseim@localhost)1&gt; cqerl:get_client(default).
 {ok,{&lt;0.474.0&gt;,#Ref&lt;0.160699839.1270874114.234457&gt;}}
 $ (mongooseim@localhost)2&gt; sys:get_state(pid(0,474,0)).
 {live,{client_state,cqerl_auth_plain_handler,undefined,
                    undefined,
                    {&quot;localhost&quot;,9042},
                    ssl,
                    {sslsocket,{gen_tcp,#Port&lt;0.8458&gt;,tls_connection,undefined},
                               &lt;0.475.0&gt;},
                    undefined,mongooseim,infinity,&lt;&lt;&gt;&gt;,undefined,
                    [...],
                    {[],[]},
                    [0,1,2,3,4,5,6,7,8,9,10,11|...],
                    [],hash,
                    {{&quot;localhost&quot;,9042},
                     [...]}}}
</code></pre>
<p>If no errors occurred and your output is similar to the one above then your MongooseIM and Cassandra nodes can communicate over SSL.</p>
<h2 id="elasticsearch-connection-setup">ElasticSearch connection setup</h2>
<p>A connection pool to ElasticSearch can be configured as follows:</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {elastic, global, default, [], [{host, &quot;localhost&quot;}]}
]}.
</code></pre>
<p>Currently only one pool with tag <code>default</code> can be used.</p>
<p>MongooseIM uses <a href="https://github.com/inaka/tirerl">inaka/tirerl</a> library to communicate with ElasticSearch.
This library uses <code>worker_pool</code> in a bit different way than MongooseIM does, so the following options are not configurable via <code>WPoolOpts</code>:</p>
<ul>
<li><code>call_timeout</code> (inifinity)</li>
<li>worker selection strategy (<code>available_worker</code> or what's set as <code>default_strategy</code> of <code>worker_pool</code> application)</li>
<li><code>overrun_warning</code> (infinity)</li>
<li><code>overrun_handler</code>, ({error_logger, warning_report})</li>
</ul>
<p>Other <code>worker_pool</code> options are possible to set.</p>
<p>In <code>ConnectionOpts</code>  you can add (as <code>{key, value}</code> pairs):</p>
<ul>
<li><code>host</code> (default: <code>"localhost"</code>) - hostname or IP address of ElasticSearch node</li>
<li><code>port</code> (default: <code>9200</code>) - port the ElasticSearch node's HTTP API is listening on</li>
</ul>
<p>Run the following function in the MongooseIM shell to verify that the connection has been established:</p>
<pre><code class="language-erlang">1&gt; mongoose_elasticsearch:health().
{ok,#{&lt;&lt;&quot;active_primary_shards&quot;&gt;&gt; =&gt; 15,&lt;&lt;&quot;active_shards&quot;&gt;&gt; =&gt; 15,
       &lt;&lt;&quot;active_shards_percent_as_number&quot;&gt;&gt; =&gt; 50.0,
       &lt;&lt;&quot;cluster_name&quot;&gt;&gt; =&gt; &lt;&lt;&quot;docker-cluster&quot;&gt;&gt;,
       &lt;&lt;&quot;delayed_unassigned_shards&quot;&gt;&gt; =&gt; 0,
       &lt;&lt;&quot;initializing_shards&quot;&gt;&gt; =&gt; 0,
       &lt;&lt;&quot;number_of_data_nodes&quot;&gt;&gt; =&gt; 1,
       &lt;&lt;&quot;number_of_in_flight_fetch&quot;&gt;&gt; =&gt; 0,
       &lt;&lt;&quot;number_of_nodes&quot;&gt;&gt; =&gt; 1,
       &lt;&lt;&quot;number_of_pending_tasks&quot;&gt;&gt; =&gt; 0,
       &lt;&lt;&quot;relocating_shards&quot;&gt;&gt; =&gt; 0,
       &lt;&lt;&quot;status&quot;&gt;&gt; =&gt; &lt;&lt;&quot;yellow&quot;&gt;&gt;,
       &lt;&lt;&quot;task_max_waiting_in_queue_millis&quot;&gt;&gt; =&gt; 0,
       &lt;&lt;&quot;timed_out&quot;&gt;&gt; =&gt; false,
       &lt;&lt;&quot;unassigned_shards&quot;&gt;&gt; =&gt; 15}}
</code></pre>
<p>Note that the output might differ based on your ElasticSearch cluster configuration.</p>
<h2 id="rabbitmq-connection-setup">RabbitMQ connection setup</h2>
<p>RabbitMQ backend for <a href="../../modules/mod_event_pusher/"><code>mod_event_pusher</code></a>
requires a <code>rabbit</code> pool defined in the <code>outgoing_pools</code> option.
They can be defined as follows:</p>
<pre><code class="language-erlang">{ougtoing_pools, [
 {rabbit, host, Tag, WorkersOptions, ConnectionOptions}
]}.
</code></pre>
<p>Notice that <code>Host</code> parameter is set to atom <code>host</code>. This basically means that
MongooseIM will start as many <code>rabbit</code> pools as XMPP hosts are served by
the server.</p>
<p>The <code>Tag</code> parameter must be set to <code>event_pusher</code> in order to be able to use
the pool for <a href="../../modules/mod_event_pusher_rabbit/"><code>mod_event_pusher_rabbit</code></a>.
Any other <code>Tag</code> can be used for any other RabbitMQ connection pool.</p>
<p>The <code>ConnectionOptions</code> list can take following parameters as <code>{key, value</code>} pairs:</p>
<ul>
<li><strong>amqp_host</strong> (default: <code>"localhost"</code>) - Defines RabbitMQ server host (domain or IP address; both as a string);</li>
<li><strong>amqp_port</strong> (default: <code>5672</code>) - Defines RabbitMQ server AMQP port;</li>
<li><strong>amqp_username</strong> (default: <code>"guest"</code>) - Defines RabbitMQ server username;</li>
<li><strong>amqp_password</strong> (default: <code>"guest"</code>) - Defines RabbitMQ server password;</li>
<li><strong>confirms_enabled</strong> (default: <code>false</code>) - Enables/disables one-to-one publishers confirms;</li>
<li><strong>max_worker_queue_len</strong> (default: <code>1000</code>; use <code>infinity</code> to disable it) -
Sets a limit of messages in a worker's mailbox above which the worker starts
dropping the messages. If a worker message queue length reaches the limit,
messages from the head of the queue are dropped until the queue length is again
below the limit.</li>
</ul>
<h3 id="example_2">Example</h3>
<pre><code class="language-erlang">{ougtoing_pools, [
 {rabbit, host, event_pusher, [{workers, 20}],
  [{amqp_host, &quot;localhost&quot;},
   {amqp_port, 5672},
   {amqp_username, &quot;guest&quot;},
   {amqp_password, &quot;guest&quot;},
   {confirms_enabled, true},
   {max_worker_queue_len, 100}]}
]}.
</code></pre>
<h2 id="ldap-connection-setup">LDAP connection setup</h2>
<p>To configure a pool of connections to an LDAP server, use the following syntax:</p>
<pre><code class="language-erlang">{ldap, Host, Tag, PoolOptions, ConnectionOptions}
</code></pre>
<h3 id="connection-options_1">Connection options</h3>
<p>The following options can be specified in the <code>ConnectionOptions</code> list:</p>
<ul>
<li>
<p><strong>servers</strong></p>
<ul>
<li><strong>Description:</strong> List of IP addresses or DNS names of your LDAP servers. They are tried sequentially until the connection succeeds.</li>
<li><strong>Value:</strong> A list of strings</li>
<li><strong>Default:</strong> <code>["localhost"]</code></li>
<li><strong>Example:</strong> <code>["primary-ldap-server.example.com", "secondary-ldap-server.example.com"]</code></li>
</ul>
</li>
<li>
<p><strong>encrypt</strong></p>
<ul>
<li><strong>Description:</strong> Enable connection encryption with your LDAP server.
    The value <code>tls</code> enables encryption by using LDAP over SSL. Note that STARTTLS encryption is not supported.</li>
<li><strong>Values:</strong> <code>none</code>, <code>tls</code></li>
<li><strong>Default:</strong> <code>none</code></li>
</ul>
</li>
<li>
<p><strong>tls_options</strong></p>
<ul>
<li><strong>Description:</strong> Specifies TLS connection options. Requires <code>{encrypt, tls}</code> (see above).</li>
<li><strong>Value:</strong> List of <code>ssl:tls_client_option()</code>. More details can be found in the <a href="http://erlang.org/doc/man/ssl.html">official Erlang ssl documentation</a>.</li>
<li><strong>Default:</strong> no options</li>
<li><strong>Example:</strong> <code>[{verify, verify_peer}, {cacertfile, "path/to/cacert.pem"}]</code></li>
</ul>
</li>
<li>
<p><strong>port</strong></p>
<ul>
<li><strong>Description:</strong> Port to connect to your LDAP server.</li>
<li><strong>Values:</strong> Integer</li>
<li><strong>Default:</strong> 389 if encryption is disabled. 636 if encryption is enabled.</li>
</ul>
</li>
<li>
<p><strong>rootdn</strong></p>
<ul>
<li><strong>Description:</strong> Bind DN</li>
<li><strong>Values:</strong> String</li>
<li><strong>Default:</strong> empty string which is <code>anonymous connection</code></li>
</ul>
</li>
<li>
<p><strong>password</strong></p>
<ul>
<li><strong>Description:</strong> Bind password</li>
<li><strong>Values:</strong> String</li>
<li><strong>Default:</strong> empty string</li>
</ul>
</li>
<li>
<p><strong>connect_interval</strong></p>
<ul>
<li><strong>Description:</strong> Interval between consecutive connection attempts in case of connection failure</li>
<li><strong>Value:</strong> Integer (milliseconds)</li>
<li><strong>Default:</strong> 10000</li>
</ul>
</li>
</ul>
<h3 id="example_3">Example</h3>
<p>A pool started for each host with the <code>default</code> tag and 5 workers. The LDAP server is at <code>ldap-server.example.com:389</code>. MongooseIM will authenticate as <code>cn=admin,dc=example,dc=com</code> with the provided password.</p>
<pre><code class="language-erlang">{outgoing_pools, [
 {ldap, host, default, [{workers, 5}],
  [{servers, [&quot;ldap-server.example.com&quot;]},
   {rootdn, &quot;cn=admin,dc=example,dc=com&quot;},
   {password, &quot;ldap-admin-password&quot;}]
 }
]}.
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Modules/" class="btn btn-neutral float-right" title="Extension Modules">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../database-backends-configuration/" class="btn btn-neutral" title="Database backends configuration"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../database-backends-configuration/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Modules/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
